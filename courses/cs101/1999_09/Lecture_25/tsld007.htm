
<HTML>

<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=windows-1252">
<meta name="GENERATOR" content="Microsoft Internet Assistant for PowerPoint 97">
 <TITLE>PPT Slide</TITLE> 
</HEAD>

<BODY     >

 <H1>PPT Slide</H1> 
 <P><UL>
 //  Handle File-&#062New-&#062Library events.
</UL><UL>
        fNewLib.addActionListener( new ActionListener() {
</UL><UL>
          public void actionPerformed( ActionEvent ae ) {
</UL><UL>
            newLib();
</UL><UL>
          } } );
</UL></P>
<P><UL>
Because there is a lot of work to do, I put the code in a separate method so the anonymous class would stay small.</UL></P>
<P><UL>
    //  Method newLib()
</UL><UL>
    //  ----------------------------------------------------------------------
</UL><UL>
    /**
</UL><UL>
      *   Interacts with the user to create a new MP3 Library
</UL><UL>
      *   file and open it as the current file.
</UL><UL>
      */
</UL><UL>
      public void newLib()
</UL><UL>
      {
</UL><UL>
        File          file  = null;
</UL><UL>
        JFileChooser  jfc   = new JFileChooser( startDir );
</UL><UL>
        MP3_Library   lib   = null;
</UL><UL>

</UL><UL>
        if ( jfc.showOpenDialog( gui ) ==
</UL><UL>
            JFileChooser.APPROVE_OPTION )
</UL><UL>
        {
</UL><UL>
          file = jfc.getSelectedFile();
</UL><UL>
          try
</UL><UL>
          {
</UL><UL>
            if ( file.exists() )
</UL><UL>
            {
</UL><UL>
              throw new Exception( "File Exists" );
</UL><UL>
            }
</UL><UL>
            file = new File ( file.getCanonicalPath() );
</UL><UL>
            MP3_Library.initializeLibraryFile( file );
</UL><UL>
            lib = new MP3_Library( file );
</UL><UL>
            close();  // See Web Page for Project 3c
</UL><UL>
            library = lib;
</UL><UL>
            startDir = file.getParent();
</UL><UL>
            addFile.setEnabled( true );
</UL><UL>
            gui.pack();
</UL><UL>
          }</UL></P>
<P><UL>
    catch ( Exception e ) // Catch any of the 3 exceptions
</UL><UL>
          {
</UL><UL>
            JOptionPane.showMessageDialog(
</UL><UL>
              gui,
</UL><UL>
              "Error: " + e.getMessage(),
</UL><UL>
              "Unable to Create Library",
</UL><UL>
              JOptionPane.ERROR_MESSAGE );
</UL><UL>
          }
</UL><UL>
        }
</UL><UL>
      }</UL></P>
<P><UL>
Might throw IOException</UL></P>
<P><UL>
Might throw InvalidLibraryFileException</UL></P>
<P><UL>
Might throw IOException</UL></P>
<P></P> 
<P>
<TABLE>
  <TD HEIGHT=100 WIDTH=100> <A HREF="tsld006.htm">Previous slide</A> </TD>
  <TD HEIGHT=100 WIDTH=100></TD>
  <TD HEIGHT=100 WIDTH=150> <A HREF="tsld001.htm">Back to first slide</A> </TD>
  <TD HEIGHT=100 WIDTH=150> <A HREF="sld007.htm">View graphic version</A> </TD>
</TABLE>
<BR>
</P>



</Body>
</HTML>
